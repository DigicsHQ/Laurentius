<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"   
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:composite="http://java.sun.com/jsf/composite"
      >
    <composite:interface>
    </composite:interface>
    <composite:implementation >



        <p:layout  id="CertTabView"  widgetVar="adminKeystoredView" style="min-width:400px;min-height:400px;height: 100%;width: 100%"  >

            <p:layoutUnit id="certTab" position="center" resizable="true" closable="true" collapsible="true"
                          size="400" minSize="400" style="width:100%;height:100%;padding: 0px; margin: 0px"
                          gutter="0"
                          >

                <p:scrollPanel mode="native" style="width:100%;height:100%"> 
                    <p:dataTable id="keylist" 
                                 value="#{adminSEDKeystoreView.list}" 
                                 var="crt" 
                                 selectionMode="single"
                                 selection="#{adminSEDKeystoreView.selected}"
                                 rowKey="#{crt.alias}"
                                 style="width:100%"
                                 scrollHeight="100%"
                                 scrollable="true"
                                 rowStyleClass="#{adminSEDKeystoreView.getRowClass(crt)}"
                                 >
                        <f:facet name="header">
                            <p:panelGrid >
                                <p:row>
                                    <p:column>Za uvoz certifikatov izberite datoteko:</p:column>
                           
                                    
                                    <p:column><p:fileUpload fileUploadListener="#{adminSEDKeyStores.handleKeystoreUpload}"
                                                            skinSimple="true" dragDropSupport="true"
                                                            uploadLabel="#{msg['Add']}" 
                                                            cancelLabel="#{msg['Cancel']}" 
                                                            label="#{msg['Browse']}" 
                                                            multiple="false"
                                                            mode="advanced"
                                                            sizeLimit="1000000" 
                                                            update=":dlgcertificate:certDialogForm:certData"
                                                            auto="true"
                                                            /> 
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column colspan="2">
                                        <p:commandButton value="#{msg['Delete']}" styleClass="toolbar-Button"                                                          
                                                         update="keylist"
                                                         icon="ui-icon-svg-remove ui-icon-size-22"  
                                                         actionListener="#{adminSEDKeystoreView.removeSelectedWithWarning()}" 
                                                         >

                                        </p:commandButton>
                                        <p:commandButton value="#{msg['Edit']}" styleClass="toolbar-Button"         
                                                         icon="ui-icon-svg-edit ui-icon-size-22"                                                    
                                                         actionListener="#{adminSEDKeystoreView.startEditSelected()}" 
                                                         oncomplete="PF('certDialog').show()"
                                                         update=":dlgcertificate:certDialogForm:certData"
                                                         >

                                        </p:commandButton>

                                    </p:column>
                                </p:row>
                            </p:panelGrid>



                        </f:facet>
                        <p:ajax event="rowDblselect" 
                                listener="#{adminSEDKeystoreView.startEditSelected()}" 
                                oncomplete="PF('certDialog').show()"
                                update=":dlgcertificate:certDialogForm:certData" />


                        <p:columnGroup type="header">
                            <p:row>
                                <p:column rowspan="2" headerText="#{msg['IsKey']}" width="40"/>
                                <p:column rowspan="2" headerText="#{msg['Alias']}" width="100" />
                                <p:column colspan="2" headerText="#{msg['Valid']}" width="120" />
                                <p:column rowspan="2" headerText="#{msg['IssuerDN']}" />
                                <p:column rowspan="2" headerText="#{msg['SubjectDN']}" />


                            </p:row>
                            <p:row>
                                <p:column headerText="#{msg['from']}" width="70" />
                                <p:column headerText="#{msg['to']}" width="70" />
                            </p:row>

                        </p:columnGroup>

                        <p:column >
                            <h:graphicImage rendered="#{crt.keyEntry}" value="#{resource['images:/privateKeyLong.svg']}" width="40" height="18" />
                            <h:graphicImage rendered="#{not crt.keyEntry}" value="#{resource['images:/certificateLong.svg']}" width="40" height="18" />
                        </p:column>     
                        <p:column width="120">
                            <h:outputText value="#{crt.alias}" />
                        </p:column>  
                        <p:column >
                            <h:outputText value="#{crt.validFrom}"  ><f:convertDateTime pattern="dd.MM.yyyy" timeZone="CET" /></h:outputText>
                        </p:column>     
                        <p:column >
                            <h:outputText value="#{crt.validTo}"  ><f:convertDateTime pattern="dd.MM.yyyy" timeZone="CET" /></h:outputText>
                        </p:column>     

                        <p:column>
                            <h:outputText value="#{crt.issuerDN}" />
                        </p:column>     
                        <p:column>
                            <h:outputText value="#{crt.subjectDN}" />
                        </p:column>     
                    </p:dataTable>
                </p:scrollPanel>
            </p:layoutUnit>
        </p:layout>

    </composite:implementation>


</html>
