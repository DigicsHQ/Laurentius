<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"   
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:pe="http://primefaces.org/ui/extensions"
      xmlns:composite="http://java.sun.com/jsf/composite"
      >
    <composite:interface>
    </composite:interface>

    <composite:implementation >

        <p:dialog  header="#{msg['PModePartyDialog']}" widgetVar="pModePartyDialog" 
                   modal="true" hideEffect="fade" resizable="false" appendTo="@(body)" height="480" width="850">

            <h:form id="pModePartyDialogForm" >
                <p:layout id="pModeParty" style="min-width:820px; height:470px; "  >

                    <p:layoutUnit position="center"   >
                        <p:tabView id="partyTab" style="height: 100%" cache="false" >                            
                            <p:tab id="IdentityTab" title="#{msg['MailData']}">
                                <f:facet name="title">

                                    <h:outputText value="#{msg['Identity']}" />
                                </f:facet>

                                <p:panelGrid  id="dataGrid"  style="width:100%; height: 80px">
                                    <p:row>
                                        <p:column colspan="6" >
                                            <hr />
                                            <b>#{msg['Identity']}</b>
                                        </p:column>
                                    </p:row>
                                    <p:row>
                                        <p:column>
                                            <h:outputText value="#{msg['Id']}:"  />
                                        </p:column>
                                        <p:column>
                                            <p:inputText id="partyId" value="#{pModePartyView.editable.id}"  style="width: 160px" >
                                            </p:inputText>
                                        </p:column>
                                        <p:column>                                    
                                            <h:outputText value="#{msg['Domain']}:"  />
                                        </p:column>
                                        <p:column>                                            
                                            <p:inputText id="domain" value="#{pModePartyView.editable.domain}"
                                                         disabled="#{pModePartyView.editableLocalIdentity}" 
                                                         style="width: 160px"  >
                                            </p:inputText>
                                        </p:column>
                                        <p:column>                                    
                                            <h:outputText value="#{msg['IsLocalIdentity']}:"  />
                                        </p:column>
                                        <p:column>
                                            <p:selectBooleanCheckbox id="locIdentity"
                                                                     value="#{pModePartyView.editableLocalIdentity}" 
                                                                     style="width: 30px"
                                                                     >  
                                                <p:ajax update=":dlgPModeParty:pModePartyDialogForm:partyTab:domain 
                                                        :dlgPModeParty:pModePartyDialogForm:partyTab:lockeystore 
                                                        :dlgPModeParty:pModePartyDialogForm:partyTab:locSignAlias 
                                                        :dlgPModeParty:pModePartyDialogForm:partyTab:locDecAlias" />
                                            </p:selectBooleanCheckbox>
                                        </p:column>
                                    </p:row>
                                    <p:row>
                                        <p:column colspan="6" >
                                            <hr />
                                            <b>#{msg['LocalIdentityCertificates']}</b>
                                        </p:column>
                                    </p:row>
                                    <p:row>
                                        <p:column>                                    
                                            <h:outputText value="#{msg['Keystore']}:"  />
                                        </p:column>
                                        <p:column>
                                            <p:selectOneMenu id="lockeystore" 
                                                             value="#{pModePartyView.editable.localPartySecurity.keystoreName}"
                                                             style="width:160px"
                                                             disabled="#{!pModePartyView.editableLocalIdentity}"
                                                            >
                                                <f:selectItem noSelectionOption="true" />
                                                <f:selectItems value="#{adminSEDKeyStores.list}" var="ks"
                                                               itemLabel="#{ks.name}" 
                                                               itemValue="#{ks.name}"
                                                               /> 
                                            
                                                <p:ajax update=":dlgPModeParty:pModePartyDialogForm:partyTab:locSignAlias :dlgPModeParty:pModePartyDialogForm:partyTab:locDecAlias" />
                                            </p:selectOneMenu>
                                        </p:column>
                                        <p:column>                                    
                                            <h:outputText value="#{msg['SignatureKeyAlias']}:"  />
                                        </p:column>
                                        <p:column>
                                            <p:selectOneMenu id="locSignAlias" 
                                                             value="#{pModePartyView.editable.localPartySecurity.signatureKeyAlias}"
                                                             style="width: 160px"
                                                             disabled="#{!pModePartyView.editableLocalIdentity}"
                                                         >
                                                <f:selectItem noSelectionOption="true" />
                                                <f:selectItems value="#{pModePartyView.currentLocalKeystoreCerts}" var="cs" itemLabel="#{cs.alias}" itemValue="#{cs.alias}" itemDisabled="#{!cs.keyEntry}" /> 
                                              
                                            </p:selectOneMenu>
                                        </p:column>
                                        <p:column>                                    
                                            <h:outputText value="#{msg['DecriptionKeyAlias']}:"  />
                                        </p:column>
                                        <p:column>
                                            <p:selectOneMenu id="locDecAlias" 
                                                             value="#{pModePartyView.editable.localPartySecurity.decryptionKeyAlias}"
                                                             style="width:160px"
                                                             disabled="#{!pModePartyView.editableLocalIdentity}"
                                                             >
                                                <f:selectItem noSelectionOption="true" />
                                                <f:selectItems value="#{pModePartyView.currentLocalKeystoreCerts}" var="cs" 
                                                               itemLabel="#{cs.alias}" itemValue="#{cs.alias}" itemDisabled="#{!cs.keyEntry}" />
      

                                            </p:selectOneMenu>


                                        </p:column>
                                    </p:row>
                                    <p:row>
                                        <p:column colspan="6" >
                                            <hr />
                                            <b>#{msg['ExchangeIdentityCertificates']}</b>
                                        </p:column>
                                    </p:row>
                                    <p:row>
                                        <p:column>                                    
                                            <h:outputText value="#{msg['Trustore']}:"  />
                                        </p:column>
                                        <p:column>
                                            <p:selectOneMenu id="exccertstore" 
                                                             value="#{pModePartyView.editable.exchangePartySecurity.trustoreName}"
                                                             style="width: 160px" >
                                                <f:selectItem noSelectionOption="true" />
                                                <f:selectItems value="#{adminSEDKeyStores.list}" var="ks" itemLabel="#{ks.name}" itemValue="#{ks.name}" />
                                                <p:ajax update=":dlgPModeParty:pModePartyDialogForm:partyTab:excSignAlias :dlgPModeParty:pModePartyDialogForm:partyTab:excencAlias" />
                                            </p:selectOneMenu>
                                        </p:column>
                                        <p:column>                                    
                                            <h:outputText value="#{msg['SignatureCertAlias']}:"  />
                                        </p:column>
                                        <p:column>
                                            <p:selectOneMenu id="excSignAlias" 
                                                             value="#{pModePartyView.editable.exchangePartySecurity.signatureCertAlias}"
                                                             style="width: 160px" >
                                                <f:selectItem noSelectionOption="true" />
                                                <f:selectItems value="#{pModePartyView.currentExchangeTruststoreCerts}" 
                                                               var="cs" itemLabel="#{cs.alias}" itemValue="#{cs.alias}" /> 
                                            </p:selectOneMenu>
                                        </p:column>
                                        <p:column>                                    
                                            <h:outputText value="#{msg['EncryptionCertAlias']}:"  />
                                        </p:column>
                                        <p:column>
                                            <p:selectOneMenu id="excencAlias" 
                                                             value="#{pModePartyView.editable.exchangePartySecurity.encryptionCertAlias}"
                                                             style="width: 160px" >
                                                <f:selectItem noSelectionOption="true" />
                                                <f:selectItems value="#{pModePartyView.currentExchangeTruststoreCerts}" 
                                                               var="cs" itemLabel="#{cs.alias}" itemValue="#{cs.alias}" /> 
                                            </p:selectOneMenu>
                                        </p:column>
                                    </p:row>
                                </p:panelGrid>

                                <hr />
                                <b>#{msg['Identity']}</b>
                                <p:dataTable id="TblIdentity" 
                                             var="sp" 
                                             value="#{pModePartyView.editable.partyIds}"
                                             style="padding: 0px; margin: 0px;box-sizing: border-box; "
                                             scrollable="true" 
                                             scrollHeight="100%"                   
                                             editable="true"
                                             editMode="cell"
                                             >
                                    <p:ajax event="cellEdit" listener="#{pModePartyView.onCellEditTableComplete}" />


                                    <p:column headerText="#{msg['Type']}" >
                                        <p:cellEditor>
                                            <f:facet name="output"><h:outputText value="#{sp.type}" /></f:facet>
                                            <f:facet name="input"><p:inputText id="type" value="#{sp.type}" style="width:100%"/></f:facet>
                                        </p:cellEditor>
                                    </p:column>


                                    <p:column headerText="#{msg['Source']}" >
                                        <p:cellEditor>
                                            <f:facet name="output"><h:outputText value="#{sp.valueSource}" /></f:facet>
                                            <f:facet name="input">
                                                <p:selectOneMenu id="source" value="#{sp.valueSource}" style = "width:100%;box-sizing: border-box;">
                                                    <f:selectItem itemLabel="name" itemValue="name" />
                                                    <f:selectItem itemLabel="address" itemValue="address" />
                                                    <f:selectItem itemLabel="identifier" itemValue="identifier" />            
                                                </p:selectOneMenu>
                                            </f:facet>
                                        </p:cellEditor>
                                    </p:column>
                                    <!-- p:column headerText="# {msg['EbmsPartIDList']}">
                                        <p:cellEditor >
                                            <f:facet name="output">
                                                <h:outputText value="# {pModePartyView.getListAsString(sp.identifiers)}" />
                                            </f:facet>
                                            <f:facet name="input">
                                                <h:outputText value="# {pModePartyView.getListAsString(sp.identifiers)}" />
                                            </f:facet>

                                        </p:cellEditor>                                                                   
                                    </p:column -->
                                </p:dataTable>




                            </p:tab>
                            <p:tab   id="TransportTab" title="#{msg['Transport']}">
                                <f:facet name="title">
                                    <h:outputText value="#{msg['Transport']}" />
                                </f:facet>
                                <hr />

                                <b><h:outputText value="#{msg['Address']}" /></b>
                                <p:panelGrid   style="width:100%;" >
                                    <p:row>
                                        <p:column>
                                            <h:outputText value="#{msg['Address']}"  />
                                        </p:column>
                                        <p:column colspan="5">
                                            <h:inputText value="#{pModePartyView.currrentAddress.value}"  style="width:100%;"/>
                                        </p:column>
                                    </p:row>
                                    <p:row>
                                        <p:column>
                                            <h:outputText value="Chunked:" />
                                        </p:column>
                                        <p:column>
                                            <p:selectBooleanCheckbox value="#{pModePartyView.currrentAddress.chunked}" />
                                        </p:column>
                                        <p:column>
                                            <h:outputText value="Connection timeout:" />
                                        </p:column>
                                        <p:column>
                                            <p:inputNumber value="#{pModePartyView.currrentAddress.connectionTimeout}" 
                                                           minValue="0" 
                                                           decimalPlaces="0" 
                                                           thousandSeparator="" />
                                        </p:column>
                                        <p:column>
                                            <h:outputText value="Receive timeout:" />
                                        </p:column>
                                        <p:column>
                                            <p:inputNumber value="#{pModePartyView.currrentAddress.receiveTimeout}"                                                           
                                                           minValue="0" 
                                                           decimalPlaces="0" 
                                                           thousandSeparator=""/>
                                        </p:column>
                                    </p:row>
                                </p:panelGrid>
                                <hr />                                
                                <b><h:outputText value="#{msg['Proxy']}" /></b>
                                <br />

                                <h:outputText value="Host"  />                                        
                                <h:inputText value="#{pModePartyView.currrentProxy.host}"  style="width: 160px" />

                                <h:outputText value="Port" />
                                <p:inputNumber value="#{pModePartyView.currrentProxy.port}" style="width: 60px" 
                                               minValue="0" 
                                               maxValue="100000" 
                                               decimalPlaces="0" 
                                               thousandSeparator="" />

                                <hr />                               
                                <b><h:outputText value="#{msg['TLS']}" /></b>

                                <p:panelGrid >
                                    <p:row>                                                                                        
                                        <p:column>
                                            <h:outputText value="#{msg['Trustore']}:" />
                                        </p:column>
                                        <p:column>
                                            <p:selectOneMenu id="tlstruststore" 
                                                             value="#{pModePartyView.currrentTransportTLS.trustStoreName}"
                                                             style="width: 160px" >

                                                <f:selectItem noSelectionOption="true" />
                                                <f:selectItems value="#{adminSEDKeyStores.list}" var="ks"
                                                               itemLabel="#{ks.name}" 
                                                               itemValue="#{ks.name}" />                                                

                                            </p:selectOneMenu>
                                        </p:column>
                                    </p:row>
                                    <p:row>
                                        <p:column>
                                            <h:outputText value="#{msg['Keystore']}:" />
                                        </p:column>
                                        <p:column>
                                            <p:selectOneMenu id="tlskeystore" 
                                                             value="#{pModePartyView.currrentTransportTLS.keyStoreName}"
                                                             style="width: 160px"  >    
                                                <p:ajax update=":dlgPModeParty:pModePartyDialogForm:partyTab:tlskeyAlias" />
                                                <f:selectItem noSelectionOption="true" />
                                                <f:selectItems value="#{adminSEDKeyStores.list}" var="ks"
                                                               itemLabel="#{ks.name}" 
                                                               itemValue="#{ks.name}"
                                                               />                                                
                                            </p:selectOneMenu>
                                        </p:column>

                                        <p:column>
                                            <h:outputText value="#{msg['KeyAlias']}:"  />
                                        </p:column>
                                        <p:column>
                                            <p:selectOneMenu id="tlskeyAlias" 
                                                             value="#{pModePartyView.currrentTransportTLS.keyAlias}"
                                                             style="width: 160px" >
                                                <f:selectItem noSelectionOption="true" />
                                                <f:selectItems value="#{pModePartyView.currentTLSKeyCerts}" 
                                                               var="cs" itemLabel="#{cs.alias}"
                                                               itemValue="#{cs.alias}" 
                                                               itemDisabled="#{!cs.keyEntry}"/> 

                                            </p:selectOneMenu>
                                        </p:column>

                                    </p:row>
                                </p:panelGrid>


                            </p:tab>
                            <!-- p:tab   id="XMLTab" title="# {msg['XML']}">
                                <f:facet name="title">

                                    <h:outputText value="# {msg['XML']}" />
                                </f:facet>


                                <pe:codeMirror id="codeMirror" mode="xml"  class="CodeMirrorXML"
                                               theme="eclipse" value="# {pModePartyView.currentObjectAsString}" 
                                               lineNumbers="true" 
                                               lineWrapping="true"
                                               readonly="true"
                                               />  
                            </p:tab -->
                        </p:tabView>

                    </p:layoutUnit>

                    <p:layoutUnit position="south"  size="40" minSize="40" maxSize="40" >
                        <p:toolbar 
                            styleClass="dialogButtonBar" >
                            <f:facet name="right"  >
                                <p:commandButton value="#{msg['Ok']}"  styleClass="toolbar-Button" 
                                                 icon="ui-icon-sed-ok" 
                                                 action="#{pModePartyView.addOrUpdateEditable()}"
                                                 oncomplete="PF('pModePartyDialog').hide()" 
                                                 update=":forms:SettingsPModesParties:TblPModeParties"
                                                 />
                                <p:commandButton value="#{msg['Cancel']}" styleClass="toolbar-Button" 
                                                 icon="ui-icon-sed-cancel"
                                                 oncomplete="PF('pModePartyDialog').hide()" 
                                                 />
                            </f:facet>
                        </p:toolbar>
                    </p:layoutUnit>
                </p:layout>
            </h:form>
        </p:dialog>


    </composite:implementation>

</html>
